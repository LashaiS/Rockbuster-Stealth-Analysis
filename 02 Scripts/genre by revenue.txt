SELECT cat.name as genre,
SUM(p.amount) AS total_revenue
FROM payment p 
JOIN rental r on p.rental_id = r.rental_id
JOIN inventory i ON r.inventory_id =i.inventory_id
JOIN film_category fc on i.film_id = fc.film_id
JOIN category cat ON fc.category_id = cat.category_id
group by cat.name
order by total_revenue DESC;
